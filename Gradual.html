<!DOCTYPE html>
<html lang="en">
<head>
     <link rel="stylesheet" href="elegant-theme.css">
    <script src="gamify.js" defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gradual Practice - Li'l Champs Abacus Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for appearance */
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        /* --- APP MODE LAYOUT (Prevents Pull-to-Refresh) --- */
        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;      
            position: fixed;       
            touch-action: none;    
            margin: 0;
            font-family: 'Nunito', sans-serif;
            background-color: #f0f9ff;
            background-image: radial-gradient(#e0f2fe 2px, transparent 2px);
            background-size: 24px 24px;
            display: flex;
            flex-direction: column;
        }

        main {
            flex-grow: 1;
            overflow-y: auto;      
            -webkit-overflow-scrolling: touch; 
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .screen-container {
            max-width: 480px;
            margin: auto;
            padding: 1.5rem;
            width: 100%;
        }

        .card {
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 5px 15px -5px rgba(0, 0, 0, 0.04);
        }

        /* Standardized Feedback Colors */
        .feedback-correct {
            border-color: #10B981 !important; 
            background-color: #ECFDF5; 
        }
        .feedback-wrong {
            border-color: #EF4444 !important; 
            background-color: #FEF2F2; 
        }

        /* Practice Buttons - Matching the Indigo Theme */
        .mode-btn {
            display: block;
            width: 100%;
            padding: 1rem;
            margin: 0.75rem 0;
            font-size: 1.1rem;
            cursor: pointer;
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
            border: none;
            border-radius: 0.75rem;
            transition: all 0.2s;
            font-weight: 700;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .mode-btn:hover { background-color: #4338ca; transform: translateY(-1px); }

        #problem-container {
            font-size: 3.5rem; 
            margin: 2rem 0;
            font-weight: 800; 
            color: #1e1b4b; /* Indigo 950 */
            text-align: center; 
            padding: 1.5rem;
            background-color: #f8fafc; 
            border-radius: 1rem;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
        }

        #user-answer {
            text-align: center !important;
            font-size: 2rem !important;
            width: 100% !important;
            padding: 1rem !important;
            border: 4px solid #e2e8f0 !important;
            border-radius: 1rem !important;
            font-weight: 800;
            transition: all 0.2s;
        }

        #step-counter {
            font-size: 0.9rem;
            color: #64748b; 
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 800;
        }
    </style>
</head>
<body oncontextmenu="return false;">
    <header class="bg-indigo-600 text-white p-4 shadow-lg sticky top-0 z-10 flex-none">
        <h1 class="text-2xl font-extrabold text-center tracking-wide">Li'l Champs Abacus Academy Ambernath</h1>
    </header>

    <main>
        <div class="screen-container">
            <div class="card">
                
                <div id="selection-screen">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 border-b pb-2">Select Practice Mode</h2>
                    <button class="mode-btn" onclick="startPractice('addition')">➕ Gradual Addition (1+2+3...)</button>
                    <button class="mode-btn" onclick="startPractice('subtraction')">➖ Gradual Subtraction (100-99...)</button>
                </div>

                <div id="exercise-screen" style="display: none;" class="text-center">
                    <div id="step-counter">Step 1 of 100</div>
                    <div id="problem-container">0 + 1</div>
                    
                    <label for="user-answer" class="block text-sm font-bold text-gray-500 mb-2 uppercase">Enter Your Total</label>
                    <input type="number" id="user-answer" placeholder="?" autofocus autocomplete="off">
                    
                    <p id="status-message" class="min-h-[2.5rem] font-bold mt-4 text-sm"></p>
                </div>

                <div id="report-screen" style="display: none;">
                    <div class="text-center mb-6">
                        <div class="bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">Mission Complete!</h2>
                    </div>

                    <div class="space-y-3 p-4 bg-slate-50 rounded-xl border border-slate-100">
                        <p class="text-sm flex justify-between"><strong>Student:</strong> <span id="report-name" class="font-bold text-indigo-600"></span></p>
                        <p class="text-sm flex justify-between"><strong>Mode:</strong> <span id="report-mode" class="font-bold"></span></p>
                        <p class="text-sm flex justify-between"><strong>Time Taken:</strong> <span id="report-time" class="font-bold text-indigo-600"></span></p>
                        <p class="text-sm flex justify-between text-gray-400 mt-2 italic"><span id="report-datetime"></span></p>
                    </div>

                    <button onclick="window.location.reload()" class="mode-btn mt-6">Restart Practice</button>
                </div>
            </div>

            <div class="w-full text-center mt-8 flex-none">
                <a href="plus_minus.html" class="text-indigo-600 hover:text-indigo-800 font-bold underline text-sm uppercase tracking-wider">
                    &larr; Back to Plus Minus
                </a>
            </div>
        </div>
    </main>
    
    <footer class="bg-white text-center p-6 mt-auto border-t border-gray-200 flex-none">
        <p class="text-sm text-gray-500">For any queries call <span class="font-bold text-indigo-600">9730482620</span></p>
    </footer>

    <script>
        let studentIdentifier = sessionStorage.getItem('studentIdentifier');
        let studentName = studentIdentifier ? studentIdentifier.split('@')[0].split('.').map(p => p.charAt(0).toUpperCase() + p.slice(1).toLowerCase()).join(' ') : 'Student'; 

        if (!studentIdentifier) { window.location.href = 'index.html'; }

        const TOTAL_STEPS = 100;
        let currentStep = 0, currentResult = 0, mode = '', startTime = null, expectedAnswer = 0;
        
        const selectionScreen = $('selection-screen'), exerciseScreen = $('exercise-screen'), reportScreen = $('report-screen');
        const problemContainer = $('problem-container'), stepCounter = $('step-counter'), userAnswerInput = $('user-answer'), statusMessage = $('status-message');

        function $(id) { return document.getElementById(id); }

        function startPractice(selectedMode) {
            mode = selectedMode; currentStep = 0; startTime = Date.now();
            if (mode === 'addition') { currentResult = 0; } 
            else { currentResult = 5050; }
            selectionScreen.style.display = 'none'; exerciseScreen.style.display = 'block';
            nextProblem();
        }

        function nextProblem() {
            currentStep++;
            if (currentStep > TOTAL_STEPS) return generateReport();
            
            let nextNumber = (mode === 'addition') ? currentStep : (TOTAL_STEPS - (currentStep - 1));
            let operator = (mode === 'addition') ? '+' : '-';
            
            expectedAnswer = (mode === 'addition') ? currentResult + nextNumber : currentResult - nextNumber;
            
            stepCounter.textContent = `Step ${currentStep} of ${TOTAL_STEPS}`;
            problemContainer.textContent = `${currentResult} ${operator} ${nextNumber}`;
            userAnswerInput.value = ''; userAnswerInput.disabled = false;
            userAnswerInput.classList.remove('feedback-correct', 'feedback-wrong');
            statusMessage.textContent = '';
            userAnswerInput.focus();
        }

        function checkAnswer() {
            const val = parseInt(userAnswerInput.value);
            if (isNaN(val)) return;

            if (val === expectedAnswer) {
                userAnswerInput.classList.add('feedback-correct');
                statusMessage.textContent = '✅ CORRECT! Press Enter...';
                statusMessage.className = 'min-h-[2.5rem] font-bold mt-4 text-sm text-green-600';
                currentResult = expectedAnswer;
                userAnswerInput.disabled = true;
                setTimeout(() => { if (currentStep < TOTAL_STEPS) nextProblem(); else generateReport(); }, 400);
            } else {
                userAnswerInput.classList.add('feedback-wrong');
                statusMessage.textContent = '❌ TRY AGAIN';
                statusMessage.className = 'min-h-[2.5rem] font-bold mt-4 text-sm text-red-600';
                userAnswerInput.value = ''; 
            }
        }

        userAnswerInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !userAnswerInput.disabled) { e.preventDefault(); checkAnswer(); }
        });

        function generateReport() {
              const totalSec = Math.round((Date.now() - startTime) / 1000);
              $('report-name').textContent = studentName;
              $('report-mode').textContent = mode === 'addition' ? 'Gradual Addition' : 'Gradual Subtraction';
              $('report-time').textContent = `${Math.floor(totalSec / 60)}m ${totalSec % 60}s`;
              $('report-datetime').textContent = new Date().toLocaleString();
              exerciseScreen.style.display = 'none'; reportScreen.style.display = 'block';
        }
    </script>
</body>
</html>
